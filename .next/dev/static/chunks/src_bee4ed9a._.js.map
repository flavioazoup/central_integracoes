{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/actions/integrations.ts"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { prisma } from '@/lib/prisma'\nimport { getCurrentTenant } from '@/server/services/tenant.service'\nimport { getCustomerById } from '@/server/services/customer.service'\nimport {\n    validateIntegrationConfig,\n    extractConfigFromFormData,\n    getDefaultIntegrationName,\n    type IntegrationProvider,\n} from './integration-schemas'\n\nexport async function saveIntegration(prevState: any, formData: FormData) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const provider = formData.get('provider') as IntegrationProvider\n    if (!provider) {\n        return { message: 'Provider é obrigatório' }\n    }\n\n    const rawData = extractConfigFromFormData(provider, formData)\n    const validation = validateIntegrationConfig(provider, rawData)\n\n    if (!validation.success) {\n        return {\n            errors: validation.errors || {},\n            message: 'Validação falhou',\n        }\n    }\n\n    const { customerId, ...configData } = validation.data!\n\n    // Verify customer belongs to this tenant\n    const customer = await getCustomerById(customerId, tenant.id)\n    if (!customer) {\n        return { message: 'Cliente não encontrado ou acesso negado' }\n    }\n\n    // Extract config object (remove customerId and provider from config)\n    const { provider: _, ...config } = configData\n\n    try {\n        await prisma.integration.upsert({\n            where: {\n                customerId_provider: {\n                    customerId,\n                    provider,\n                },\n            },\n            update: {\n                config,\n                isActive: true,\n            },\n            create: {\n                tenantId: tenant.id,\n                customerId,\n                provider,\n                name: getDefaultIntegrationName(provider),\n                config,\n            },\n        })\n\n        revalidatePath('/dashboard/integrations')\n        return { message: 'Success' }\n    } catch (error) {\n        console.error('Error saving integration:', error)\n        return { message: 'Falha ao salvar integração' }\n    }\n}\n\n// Mantido para compatibilidade (pode ser removido depois)\nexport async function saveNuvemShopIntegration(prevState: any, formData: FormData) {\n    formData.set('provider', 'nuvemshop')\n    return saveIntegration(prevState, formData)\n}\n\nexport async function getIntegrations(customerId?: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    // If customerId is provided, verify it belongs to this tenant\n    if (customerId) {\n        const customer = await getCustomerById(customerId, tenant.id)\n        if (!customer) return []\n    }\n\n    const integrations = await prisma.integration.findMany({\n        where: customerId\n            ? { customerId }\n            : {\n                customer: {\n                    tenantId: tenant.id,\n                },\n            },\n        include: {\n            customer: {\n                select: {\n                    id: true,\n                    name: true,\n                    isActive: true,\n                },\n            },\n        },\n        orderBy: { createdAt: 'desc' },\n    })\n\n    return integrations\n}\n\n"],"names":[],"mappings":";;;;;;;MAasB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,mDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/actions/integration-schemas.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport type IntegrationProvider = 'nuvemshop' | 'bling' | 'tiny' | 'mercadolivre' | 'tray'\n\nexport const INTEGRATION_PROVIDERS: Array<{\n    value: IntegrationProvider\n    label: string\n    description?: string\n}> = [\n    { value: 'nuvemshop', label: 'NuvemShop', description: 'Plataforma de e-commerce brasileira' },\n    { value: 'bling', label: 'Bling', description: 'Sistema de gestão ERP' },\n    { value: 'tiny', label: 'Olist (Tiny)', description: 'ERP Olist / Tiny - API 2.0' },\n    { value: 'mercadolivre', label: 'Mercado Livre', description: 'Marketplace online' },\n    { value: 'tray', label: 'Tray', description: 'Plataforma de e-commerce' },\n]\n\n// NuvemShop Schema\nconst NuvemShopConfigSchema = z.object({\n    accessToken: z.string().min(1, 'Access token é obrigatório'),\n    userId: z.string().min(1, 'Store ID (User ID) é obrigatório'),\n    userAgent: z.string().min(1, 'User Agent é obrigatório'),\n})\n\n// Bling Schema\nconst BlingConfigSchema = z.object({\n    apiKey: z.string().min(1, 'API Key é obrigatória'),\n})\n\n// Tiny Schema\nconst TinyConfigSchema = z.object({\n    token: z.string().min(1, 'Token é obrigatório'),\n    empresaId: z.string().min(1, 'ID da Empresa é obrigatório'),\n})\n\n// Mercado Livre Schema\nconst MercadoLivreConfigSchema = z.object({\n    accessToken: z.string().min(1, 'Access Token é obrigatório'),\n    refreshToken: z.string().min(1, 'Refresh Token é obrigatório'),\n    clientId: z.string().min(1, 'Client ID é obrigatório'),\n    clientSecret: z.string().min(1, 'Client Secret é obrigatório'),\n    userId: z.string().min(1, 'User ID é obrigatório'),\n})\n\n// Tray Schema\nconst TrayConfigSchema = z.object({\n    storeId: z.string().min(1, 'Store ID é obrigatório'),\n    accessToken: z.string().min(1, 'Access Token é obrigatório'),\n})\n\n// Base schema com provider e customerId\nconst BaseIntegrationSchema = z.object({\n    customerId: z.string().min(1, 'Cliente é obrigatório'),\n    provider: z.enum(['nuvemshop', 'bling', 'tiny', 'mercadolivre', 'tray']),\n})\n\n// Schema union para cada provider\nexport const IntegrationConfigSchemas = {\n    nuvemshop: BaseIntegrationSchema.extend({\n        provider: z.literal('nuvemshop'),\n        ...NuvemShopConfigSchema.shape,\n    }),\n    bling: BaseIntegrationSchema.extend({\n        provider: z.literal('bling'),\n        ...BlingConfigSchema.shape,\n    }),\n    tiny: BaseIntegrationSchema.extend({\n        provider: z.literal('tiny'),\n        ...TinyConfigSchema.shape,\n    }),\n    mercadolivre: BaseIntegrationSchema.extend({\n        provider: z.literal('mercadolivre'),\n        ...MercadoLivreConfigSchema.shape,\n    }),\n    tray: BaseIntegrationSchema.extend({\n        provider: z.literal('tray'),\n        ...TrayConfigSchema.shape,\n    }),\n}\n\n// Helper para validar config baseado no provider\nexport function validateIntegrationConfig(\n    provider: IntegrationProvider,\n    data: unknown\n): { success: boolean; data?: any; errors?: Record<string, string[]> } {\n    const schema = IntegrationConfigSchemas[provider]\n    const result = schema.safeParse(data)\n\n    if (!result.success) {\n        return {\n            success: false,\n            errors: result.error.flatten().fieldErrors,\n        }\n    }\n\n    return {\n        success: true,\n        data: result.data,\n    }\n}\n\n// Helper para extrair config do FormData baseado no provider\nexport function extractConfigFromFormData(\n    provider: IntegrationProvider,\n    formData: FormData\n): Record<string, unknown> {\n    const base = {\n        customerId: formData.get('customerId'),\n        provider,\n    }\n\n    switch (provider) {\n        case 'nuvemshop':\n            return {\n                ...base,\n                accessToken: formData.get('accessToken'),\n                userId: formData.get('userId'),\n                userAgent: formData.get('userAgent'),\n            }\n        case 'bling':\n            return {\n                ...base,\n                apiKey: formData.get('apiKey'),\n            }\n        case 'tiny':\n            return {\n                ...base,\n                token: formData.get('token'),\n                empresaId: formData.get('empresaId'),\n            }\n        case 'mercadolivre':\n            return {\n                ...base,\n                accessToken: formData.get('accessToken'),\n                refreshToken: formData.get('refreshToken'),\n                clientId: formData.get('clientId'),\n                clientSecret: formData.get('clientSecret'),\n                userId: formData.get('userId'),\n            }\n        case 'tray':\n            return {\n                ...base,\n                storeId: formData.get('storeId'),\n                accessToken: formData.get('accessToken'),\n            }\n        default:\n            return base\n    }\n}\n\n// Helper para obter nome padrão da integração\nexport function getDefaultIntegrationName(provider: IntegrationProvider): string {\n    const names: Record<IntegrationProvider, string> = {\n        nuvemshop: 'NuvemShop Store',\n        bling: 'Bling ERP',\n        tiny: 'Olist (Tiny)',\n        mercadolivre: 'Mercado Livre',\n        tray: 'Tray Store',\n    }\n    return names[provider]\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/app/dashboard/integrations/integration-form.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useFormStatus, useFormState } from 'react-dom'\nimport { saveIntegration } from '@/server/actions/integrations'\nimport { cn } from '@/lib/utils'\nimport { INTEGRATION_PROVIDERS, type IntegrationProvider } from '@/server/actions/integration-schemas'\nimport type { Customer } from '@prisma/client'\n\ninterface FormState {\n    message: string | null\n    errors?: Record<string, string[]>\n}\n\nconst initialState: FormState = {\n    message: null,\n}\n\nfunction SubmitButton() {\n    const { pending } = useFormStatus()\n\n    return (\n        <button\n            type=\"submit\"\n            disabled={pending}\n            className={cn(\n                'w-full rounded-md px-4 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2',\n                pending ? 'bg-indigo-400' : 'bg-indigo-600 hover:bg-indigo-500 focus-visible:outline-indigo-600'\n            )}\n        >\n            {pending ? 'Salvando...' : 'Salvar Integração'}\n        </button>\n    )\n}\n\ninterface IntegrationFormProps {\n    customers: Customer[]\n    onSuccess?: () => void\n}\n\nexport function IntegrationForm({ customers, onSuccess }: IntegrationFormProps) {\n    const [state, formAction] = useFormState(saveIntegration, initialState)\n    const [selectedProvider, setSelectedProvider] = useState<IntegrationProvider>('nuvemshop')\n\n    // Call onSuccess when form is successfully submitted\n    useEffect(() => {\n        if (state?.message === 'Success' && onSuccess) {\n            onSuccess()\n        }\n    }, [state?.message, onSuccess])\n\n    if (customers.length === 0) {\n        return (\n            <div className=\"rounded-lg bg-yellow-50 p-6 shadow\">\n                <p className=\"text-sm text-yellow-800\">\n                    Você precisa criar um cliente antes de configurar integrações.\n                </p>\n                <a\n                    href=\"/dashboard/customers/new\"\n                    className=\"mt-4 inline-block rounded-md bg-yellow-600 px-4 py-2 text-sm font-medium text-white hover:bg-yellow-700\"\n                >\n                    Criar Cliente\n                </a>\n            </div>\n        )\n    }\n\n    const renderProviderFields = () => {\n        switch (selectedProvider) {\n            case 'nuvemshop':\n                return (\n                    <>\n                        <div>\n                            <label htmlFor=\"accessToken\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Access Token <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"accessToken\"\n                                    name=\"accessToken\"\n                                    type=\"password\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.accessToken && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.accessToken[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"userId\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Store ID (User ID) <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"userId\"\n                                    name=\"userId\"\n                                    type=\"text\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.userId && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.userId[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"userAgent\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                User Agent (AppName (email)) <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"userAgent\"\n                                    name=\"userAgent\"\n                                    type=\"text\"\n                                    required\n                                    placeholder=\"My App (email@example.com)\"\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.userAgent && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.userAgent[0]}</p>\n                            )}\n                        </div>\n                    </>\n                )\n\n            case 'bling':\n                return (\n                    <div>\n                        <label htmlFor=\"apiKey\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                            API Key <span className=\"text-red-500\">*</span>\n                        </label>\n                        <div className=\"mt-2\">\n                            <input\n                                id=\"apiKey\"\n                                name=\"apiKey\"\n                                type=\"password\"\n                                required\n                                className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                            />\n                        </div>\n                        {state?.errors?.apiKey && (\n                            <p className=\"mt-1 text-sm text-red-600\">{state.errors.apiKey[0]}</p>\n                        )}\n                    </div>\n                )\n\n            case 'tiny':\n                return (\n                    <>\n                        <div>\n                            <label htmlFor=\"token\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Token <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"token\"\n                                    name=\"token\"\n                                    type=\"password\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.token && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.token[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"empresaId\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                ID da Empresa <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"empresaId\"\n                                    name=\"empresaId\"\n                                    type=\"text\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.empresaId && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.empresaId[0]}</p>\n                            )}\n                        </div>\n                    </>\n                )\n\n            case 'mercadolivre':\n                return (\n                    <>\n                        <div>\n                            <label htmlFor=\"accessToken\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Access Token <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"accessToken\"\n                                    name=\"accessToken\"\n                                    type=\"password\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.accessToken && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.accessToken[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"refreshToken\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Refresh Token <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"refreshToken\"\n                                    name=\"refreshToken\"\n                                    type=\"password\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.refreshToken && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.refreshToken[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"clientId\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Client ID <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"clientId\"\n                                    name=\"clientId\"\n                                    type=\"text\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.clientId && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.clientId[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"clientSecret\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Client Secret <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"clientSecret\"\n                                    name=\"clientSecret\"\n                                    type=\"password\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.clientSecret && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.clientSecret[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"userId\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                User ID <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"userId\"\n                                    name=\"userId\"\n                                    type=\"text\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.userId && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.userId[0]}</p>\n                            )}\n                        </div>\n                    </>\n                )\n\n            case 'tray':\n                return (\n                    <>\n                        <div>\n                            <label htmlFor=\"storeId\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Store ID <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"storeId\"\n                                    name=\"storeId\"\n                                    type=\"text\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.storeId && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.storeId[0]}</p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"accessToken\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                                Access Token <span className=\"text-red-500\">*</span>\n                            </label>\n                            <div className=\"mt-2\">\n                                <input\n                                    id=\"accessToken\"\n                                    name=\"accessToken\"\n                                    type=\"password\"\n                                    required\n                                    className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                                />\n                            </div>\n                            {state?.errors?.accessToken && (\n                                <p className=\"mt-1 text-sm text-red-600\">{state.errors.accessToken[0]}</p>\n                            )}\n                        </div>\n                    </>\n                )\n\n            default:\n                return null\n        }\n    }\n\n    return (\n        <form action={formAction} className=\"space-y-4 rounded-lg bg-white p-6 shadow\">\n            <input type=\"hidden\" name=\"provider\" value={selectedProvider} />\n\n            <div>\n                <label htmlFor=\"provider\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                    Plataforma <span className=\"text-red-500\">*</span>\n                </label>\n                <div className=\"mt-2\">\n                    <select\n                        id=\"provider\"\n                        value={selectedProvider}\n                        onChange={(e) => setSelectedProvider(e.target.value as IntegrationProvider)}\n                        className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                    >\n                        {INTEGRATION_PROVIDERS.map((provider) => (\n                            <option key={provider.value} value={provider.value}>\n                                {provider.label}\n                            </option>\n                        ))}\n                    </select>\n                </div>\n                {INTEGRATION_PROVIDERS.find((p) => p.value === selectedProvider)?.description && (\n                    <p className=\"mt-1 text-xs text-gray-500\">\n                        {INTEGRATION_PROVIDERS.find((p) => p.value === selectedProvider)?.description}\n                    </p>\n                )}\n            </div>\n\n            <div>\n                <label htmlFor=\"customerId\" className=\"block text-sm font-medium leading-6 text-gray-900\">\n                    Cliente <span className=\"text-red-500\">*</span>\n                </label>\n                <div className=\"mt-2\">\n                    <select\n                        id=\"customerId\"\n                        name=\"customerId\"\n                        required\n                        className=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n                    >\n                        <option value=\"\">Selecione um cliente</option>\n                        {customers.map((customer) => (\n                            <option key={customer.id} value={customer.id}>\n                                {customer.name}\n                            </option>\n                        ))}\n                    </select>\n                </div>\n                {state?.errors?.customerId && (\n                    <p className=\"mt-1 text-sm text-red-600\">{state.errors.customerId[0]}</p>\n                )}\n            </div>\n\n            {renderProviderFields()}\n\n            <div className=\"pt-2\">\n                <SubmitButton />\n            </div>\n\n            {state?.message && (\n                <p className={cn(\"text-sm\", state.message === 'Success' ? 'text-green-600' : 'text-red-600')}>\n                    {state.message}\n                </p>\n            )}\n        </form>\n    )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1185, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/app/dashboard/integrations/integration-modal.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { X, Plus } from 'lucide-react'\nimport { IntegrationForm } from './integration-form'\nimport type { Customer } from '@prisma/client'\n\ninterface IntegrationModalProps {\n    customers: Customer[]\n}\n\nexport function IntegrationModal({ customers }: IntegrationModalProps) {\n    const [isOpen, setIsOpen] = useState(false)\n    const [successTrigger, setSuccessTrigger] = useState(0)\n    const router = useRouter()\n\n    const handleSuccess = () => {\n        setIsOpen(false)\n        // Trigger a refresh of the page data\n        router.refresh()\n    }\n\n    // Reset form state when modal closes\n    useEffect(() => {\n        if (!isOpen) {\n            // Reset form by changing key after a short delay\n            setTimeout(() => {\n                setSuccessTrigger((prev) => prev + 1)\n            }, 100)\n        }\n    }, [isOpen])\n\n    const handleClose = () => {\n        setIsOpen(false)\n    }\n\n    return (\n        <>\n            <button\n                onClick={() => setIsOpen(true)}\n                className=\"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\"\n            >\n                <Plus className=\"h-4 w-4\" />\n                Incluir Integração\n            </button>\n\n            {isOpen && (\n                <div \n                    className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50\"\n                    onClick={handleClose}\n                >\n                    <div \n                        className=\"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col\"\n                        onClick={(e) => e.stopPropagation()}\n                    >\n                        <div className=\"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-indigo-50\">\n                            <div className=\"flex items-center gap-2 text-indigo-700\">\n                                <Plus className=\"h-6 w-6\" />\n                                <h2 className=\"text-xl font-bold\">Nova Integração</h2>\n                            </div>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                            >\n                                <X className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <div className=\"flex-1 overflow-y-auto p-6\">\n                            <IntegrationForm \n                                customers={customers} \n                                onSuccess={handleSuccess}\n                                key={successTrigger}\n                            />\n                        </div>\n                    </div>\n                </div>\n            )}\n        </>\n    )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AACA;;;AALA;;;;;AAYO,SAAS,iBAAiB,EAAE,SAAS,EAAyB;;IACjE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,gBAAgB;QAClB,UAAU;QACV,qCAAqC;QACrC,OAAO,OAAO;IAClB;IAEA,qCAAqC;IACrC,IAAA,0KAAS;sCAAC;YACN,IAAI,CAAC,QAAQ;gBACT,iDAAiD;gBACjD;kDAAW;wBACP;0DAAkB,CAAC,OAAS,OAAO;;oBACvC;iDAAG;YACP;QACJ;qCAAG;QAAC;KAAO;IAEX,MAAM,cAAc;QAChB,UAAU;IACd;IAEA,qBACI;;0BACI,6LAAC;gBACG,SAAS,IAAM,UAAU;gBACzB,WAAU;;kCAEV,6LAAC,6MAAI;wBAAC,WAAU;;;;;;oBAAY;;;;;;;YAI/B,wBACG,6LAAC;gBACG,WAAU;gBACV,SAAS;0BAET,cAAA,6LAAC;oBACG,WAAU;oBACV,SAAS,CAAC,IAAM,EAAE,eAAe;;sCAEjC,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC,6MAAI;4CAAC,WAAU;;;;;;sDAChB,6LAAC;4CAAG,WAAU;sDAAoB;;;;;;;;;;;;8CAEtC,6LAAC;oCACG,SAAS;oCACT,WAAU;8CAEV,cAAA,6LAAC,oMAAC;wCAAC,WAAU;;;;;;;;;;;;;;;;;sCAIrB,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC,qLAAe;gCACZ,WAAW;gCACX,WAAW;+BACN;;;;;;;;;;;;;;;;;;;;;;;AAQrC;GArEgB;;QAGG,kJAAS;;;KAHZ"}},
    {"offset": {"line": 1351, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/components/customer-filter.tsx"],"sourcesContent":["'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { User, SlidersHorizontal } from 'lucide-react'\nimport type { Customer } from '@prisma/client'\n\ninterface CustomerFilterProps {\n    customers: Customer[]\n    currentCustomerId?: string\n}\n\nconst selectClass =\n    'w-full rounded-lg border border-gray-200 bg-white py-2.5 pl-10 pr-4 text-sm text-gray-900 shadow-sm transition focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/20'\n\nexport function CustomerFilter({ customers, currentCustomerId }: CustomerFilterProps) {\n    const router = useRouter()\n\n    if (customers.length === 0) {\n        return null\n    }\n\n    return (\n        <div className=\"rounded-xl border border-gray-200/80 bg-white p-5 shadow-sm\">\n            <div className=\"flex flex-wrap items-center gap-4\">\n                <div className=\"flex items-center gap-2 text-gray-500\">\n                    <SlidersHorizontal className=\"h-5 w-5\" />\n                    <span className=\"text-sm font-medium text-gray-700\">Filtrar por cliente</span>\n                </div>\n                <div className=\"relative flex-1 min-w-[200px] max-w-[280px]\">\n                    <User className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400 pointer-events-none\" />\n                    <label htmlFor=\"customer-filter\" className=\"sr-only\">\n                        Cliente\n                    </label>\n                    <select\n                        id=\"customer-filter\"\n                        className={selectClass}\n                        value={currentCustomerId || ''}\n                        onChange={(e) => {\n                            const value = e.target.value\n                            if (value) {\n                                router.push(`/dashboard/integrations?customerId=${value}`)\n                            } else {\n                                router.push('/dashboard/integrations')\n                            }\n                        }}\n                    >\n                        <option value=\"\">Todos os clientes</option>\n                        {customers.map((customer) => (\n                            <option key={customer.id} value={customer.id}>\n                                {customer.name}\n                            </option>\n                        ))}\n                    </select>\n                </div>\n            </div>\n        </div>\n    )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAHA;;;AAWA,MAAM,cACF;AAEG,SAAS,eAAe,EAAE,SAAS,EAAE,iBAAiB,EAAuB;;IAChF,MAAM,SAAS,IAAA,kJAAS;IAExB,IAAI,UAAU,MAAM,KAAK,GAAG;QACxB,OAAO;IACX;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC,wPAAiB;4BAAC,WAAU;;;;;;sCAC7B,6LAAC;4BAAK,WAAU;sCAAoC;;;;;;;;;;;;8BAExD,6LAAC;oBAAI,WAAU;;sCACX,6LAAC,6MAAI;4BAAC,WAAU;;;;;;sCAChB,6LAAC;4BAAM,SAAQ;4BAAkB,WAAU;sCAAU;;;;;;sCAGrD,6LAAC;4BACG,IAAG;4BACH,WAAW;4BACX,OAAO,qBAAqB;4BAC5B,UAAU,CAAC;gCACP,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gCAC5B,IAAI,OAAO;oCACP,OAAO,IAAI,CAAC,CAAC,mCAAmC,EAAE,OAAO;gCAC7D,OAAO;oCACH,OAAO,IAAI,CAAC;gCAChB;4BACJ;;8CAEA,6LAAC;oCAAO,OAAM;8CAAG;;;;;;gCAChB,UAAU,GAAG,CAAC,CAAC,yBACZ,6LAAC;wCAAyB,OAAO,SAAS,EAAE;kDACvC,SAAS,IAAI;uCADL,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASpD;GA3CgB;;QACG,kJAAS;;;KADZ"}},
    {"offset": {"line": 1487, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/actions/sync.ts"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { prisma } from '@/lib/prisma'\nimport { getCurrentTenant } from '@/server/services/tenant.service'\nimport { syncQueue } from '@/server/jobs/queue'\n\nexport async function triggerSync(integrationId: string, type: 'products' | 'orders') {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    try {\n        // 1. Create SyncJob record\n        const job = await prisma.syncJob.create({\n            data: {\n                tenantId: tenant.id,\n                integrationId,\n                type,\n                status: 'pending',\n            },\n        })\n\n        // 2. Add to BullMQ\n        await syncQueue.add(type, {\n            tenantId: tenant.id,\n            integrationId,\n            jobId: job.id,\n            type,\n        })\n\n        revalidatePath('/dashboard/sync-status')\n        return { message: 'Sync started' }\n    } catch (error) {\n        return { message: 'Failed to start sync' }\n    }\n}\n"],"names":[],"mappings":";;;;;;;MAOsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,+CAAA"}},
    {"offset": {"line": 1504, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/app/dashboard/integrations/integration-actions.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { triggerSync } from '@/server/actions/sync'\nimport { RefreshCw, Package, ShoppingCart } from 'lucide-react'\n\ninterface IntegrationActionsProps {\n    integrationId: string\n}\n\nexport function IntegrationActions({ integrationId }: IntegrationActionsProps) {\n    const [loading, setLoading] = useState<'products' | 'orders' | null>(null)\n    const [message, setMessage] = useState<{ type: 'success' | 'error', text: string } | null>(null)\n\n    const handleSync = async (type: 'products' | 'orders') => {\n        setLoading(type)\n        setMessage(null)\n\n        try {\n            const result = await triggerSync(integrationId, type)\n\n            if (result.message === 'Sync started') {\n                setMessage({ type: 'success', text: `${type === 'products' ? 'Products' : 'Orders'} sync started!` })\n                // Refresh the page after a short delay to show updated jobs\n                setTimeout(() => {\n                    window.location.reload()\n                }, 1500)\n            } else {\n                setMessage({ type: 'error', text: result.message })\n            }\n        } catch (error) {\n            setMessage({ type: 'error', text: 'Failed to start sync' })\n        } finally {\n            setLoading(null)\n        }\n    }\n\n    return (\n        <div className=\"space-y-3\">\n            {message && (\n                <div className={`rounded-md p-3 text-sm ${message.type === 'success'\n                        ? 'bg-green-50 text-green-800'\n                        : 'bg-red-50 text-red-800'\n                    }`}>\n                    {message.text}\n                </div>\n            )}\n\n            <div className=\"flex gap-2\">\n                <button\n                    onClick={() => handleSync('products')}\n                    disabled={loading !== null}\n                    className=\"flex-1 inline-flex items-center justify-center gap-2 rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                    {loading === 'products' ? (\n                        <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                        <Package className=\"h-4 w-4\" />\n                    )}\n                    Sync Products\n                </button>\n\n                <button\n                    onClick={() => handleSync('orders')}\n                    disabled={loading !== null}\n                    className=\"flex-1 inline-flex items-center justify-center gap-2 rounded-md bg-green-600 px-3 py-2 text-sm font-medium text-white hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                    {loading === 'orders' ? (\n                        <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                        <ShoppingCart className=\"h-4 w-4\" />\n                    )}\n                    Sync Orders\n                </button>\n            </div>\n        </div>\n    )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;;;AAJA;;;;AAUO,SAAS,mBAAmB,EAAE,aAAa,EAA2B;;IACzE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAA+B;IACrE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAqD;IAE3F,MAAM,aAAa,OAAO;QACtB,WAAW;QACX,WAAW;QAEX,IAAI;YACA,MAAM,SAAS,MAAM,IAAA,kLAAW,EAAC,eAAe;YAEhD,IAAI,OAAO,OAAO,KAAK,gBAAgB;gBACnC,WAAW;oBAAE,MAAM;oBAAW,MAAM,GAAG,SAAS,aAAa,aAAa,SAAS,cAAc,CAAC;gBAAC;gBACnG,4DAA4D;gBAC5D,WAAW;oBACP,OAAO,QAAQ,CAAC,MAAM;gBAC1B,GAAG;YACP,OAAO;gBACH,WAAW;oBAAE,MAAM;oBAAS,MAAM,OAAO,OAAO;gBAAC;YACrD;QACJ,EAAE,OAAO,OAAO;YACZ,WAAW;gBAAE,MAAM;gBAAS,MAAM;YAAuB;QAC7D,SAAU;YACN,WAAW;QACf;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;YACV,yBACG,6LAAC;gBAAI,WAAW,CAAC,uBAAuB,EAAE,QAAQ,IAAI,KAAK,YACjD,+BACA,0BACJ;0BACD,QAAQ,IAAI;;;;;;0BAIrB,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBACG,SAAS,IAAM,WAAW;wBAC1B,UAAU,YAAY;wBACtB,WAAU;;4BAET,YAAY,2BACT,6LAAC,gOAAS;gCAAC,WAAU;;;;;qDAErB,6LAAC,sNAAO;gCAAC,WAAU;;;;;;4BACrB;;;;;;;kCAIN,6LAAC;wBACG,SAAS,IAAM,WAAW;wBAC1B,UAAU,YAAY;wBACtB,WAAU;;4BAET,YAAY,yBACT,6LAAC,gOAAS;gCAAC,WAAU;;;;;qDAErB,6LAAC,yOAAY;gCAAC,WAAU;;;;;;4BAC1B;;;;;;;;;;;;;;;;;;;AAMtB;GAnEgB;KAAA"}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/actions/customers.ts"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\nimport { z } from 'zod'\nimport { getCurrentTenant } from '@/server/services/tenant.service'\nimport {\n    createCustomer,\n    updateCustomer,\n    deleteCustomer,\n    getCustomers,\n    getCustomerById,\n    getCustomerWithIntegrations,\n    getActiveCustomers,\n} from '@/server/services/customer.service'\n\nconst CustomerSchema = z.object({\n    name: z.string().min(1, 'Nome é obrigatório'),\n    email: z.string().email('Email inválido').optional().or(z.literal('')),\n    phone: z.string().optional(),\n    document: z.string().optional(),\n    notes: z.string().optional(),\n})\n\nexport async function createCustomerAction(prevState: any, formData: FormData) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const rawData = {\n        name: formData.get('name'),\n        email: formData.get('email'),\n        phone: formData.get('phone'),\n        document: formData.get('document'),\n        notes: formData.get('notes'),\n    }\n\n    const validatedFields = CustomerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: 'Validation failed',\n        }\n    }\n\n    let customerId: string | undefined\n    try {\n        const customer = await createCustomer(\n            {\n                name: validatedFields.data.name,\n                email: validatedFields.data.email || undefined,\n                phone: validatedFields.data.phone || undefined,\n                document: validatedFields.data.document || undefined,\n                notes: validatedFields.data.notes || undefined,\n            },\n            tenant.id\n        )\n\n        revalidatePath('/dashboard/customers')\n        customerId = customer.id\n    } catch (error) {\n        return { message: 'Failed to create customer' }\n    }\n\n    if (customerId) {\n        redirect(`/dashboard/customers/${customerId}`)\n    }\n}\n\nexport async function updateCustomerAction(\n    customerId: string,\n    prevState: any,\n    formData: FormData\n) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const rawData = {\n        name: formData.get('name'),\n        email: formData.get('email'),\n        phone: formData.get('phone'),\n        document: formData.get('document'),\n        notes: formData.get('notes'),\n    }\n\n    const validatedFields = CustomerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: 'Validation failed',\n        }\n    }\n\n    try {\n        await updateCustomer(\n            customerId,\n            {\n                name: validatedFields.data.name,\n                email: validatedFields.data.email || undefined,\n                phone: validatedFields.data.phone || undefined,\n                document: validatedFields.data.document || undefined,\n                notes: validatedFields.data.notes || undefined,\n            },\n            tenant.id\n        )\n\n        revalidatePath('/dashboard/customers')\n        revalidatePath(`/dashboard/customers/${customerId}`)\n        return { message: 'Success' }\n    } catch (error) {\n        return { message: 'Failed to update customer' }\n    }\n}\n\nexport async function deleteCustomerAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    try {\n        await deleteCustomer(customerId, tenant.id)\n        revalidatePath('/dashboard/customers')\n        redirect('/dashboard/customers')\n    } catch (error) {\n        return { message: 'Failed to delete customer' }\n    }\n}\n\nexport async function getCustomersAction() {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await getCustomers(tenant.id)\n}\n\nexport async function getActiveCustomersAction() {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await getActiveCustomers(tenant.id)\n}\n\nexport async function getCustomerByIdAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return null\n\n    return await getCustomerById(customerId, tenant.id)\n}\n\nexport async function getCustomerWithIntegrationsAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return null\n\n    return await getCustomerWithIntegrations(customerId, tenant.id)\n}\n"],"names":[],"mappings":";;;;;;;MAuHsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,wDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/app/dashboard/customers/%5Bid%5D/delete-button.tsx"],"sourcesContent":["'use client'\n\nimport { deleteCustomerAction } from '@/server/actions/customers'\nimport { Trash2 } from 'lucide-react'\nimport { useState } from 'react'\n\ninterface DeleteCustomerButtonProps {\n    customerId: string\n}\n\nexport function DeleteCustomerButton({ customerId }: DeleteCustomerButtonProps) {\n    const [isDeleting, setIsDeleting] = useState(false)\n    const [showConfirm, setShowConfirm] = useState(false)\n\n    const handleDelete = async () => {\n        setIsDeleting(true)\n        try {\n            await deleteCustomerAction(customerId)\n        } catch (error) {\n            setIsDeleting(false)\n            alert('Erro ao deletar cliente')\n        }\n    }\n\n    if (showConfirm) {\n        return (\n            <div className=\"flex gap-2\">\n                <button\n                    onClick={() => setShowConfirm(false)}\n                    className=\"rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50\"\n                >\n                    Cancelar\n                </button>\n                <button\n                    onClick={handleDelete}\n                    disabled={isDeleting}\n                    className=\"rounded-md bg-red-600 px-3 py-2 text-sm font-medium text-white hover:bg-red-700 disabled:opacity-50\"\n                >\n                    {isDeleting ? 'Deletando...' : 'Confirmar'}\n                </button>\n            </div>\n        )\n    }\n\n    return (\n        <button\n            onClick={() => setShowConfirm(true)}\n            className=\"inline-flex items-center gap-2 rounded-md border border-red-300 bg-white px-4 py-2 text-sm font-medium text-red-700 hover:bg-red-50\"\n        >\n            <Trash2 className=\"h-4 w-4\" />\n            Deletar\n        </button>\n    )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAUO,SAAS,qBAAqB,EAAE,UAAU,EAA6B;;IAC1E,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,MAAM,eAAe;QACjB,cAAc;QACd,IAAI;YACA,MAAM,IAAA,2LAAoB,EAAC;QAC/B,EAAE,OAAO,OAAO;YACZ,cAAc;YACd,MAAM;QACV;IACJ;IAEA,IAAI,aAAa;QACb,qBACI,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBACG,SAAS,IAAM,eAAe;oBAC9B,WAAU;8BACb;;;;;;8BAGD,6LAAC;oBACG,SAAS;oBACT,UAAU;oBACV,WAAU;8BAET,aAAa,iBAAiB;;;;;;;;;;;;IAI/C;IAEA,qBACI,6LAAC;QACG,SAAS,IAAM,eAAe;QAC9B,WAAU;;0BAEV,6LAAC,uNAAM;gBAAC,WAAU;;;;;;YAAY;;;;;;;AAI1C;GA3CgB;KAAA"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/trash-2.js","sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/node_modules/lucide-react/src/icons/trash-2.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M10 11v6', key: 'nco0om' }],\n  ['path', { d: 'M14 11v6', key: 'outv1u' }],\n  ['path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6', key: 'miytrc' }],\n  ['path', { d: 'M3 6h18', key: 'd0wm0j' }],\n  ['path', { d: 'M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2', key: 'e791ji' }],\n];\n\n/**\n * @component @name Trash2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTAgMTF2NiIgLz4KICA8cGF0aCBkPSJNMTQgMTF2NiIgLz4KICA8cGF0aCBkPSJNMTkgNnYxNGEyIDIgMCAwIDEtMiAySDdhMiAyIDAgMCAxLTItMlY2IiAvPgogIDxwYXRoIGQ9Ik0zIDZoMTgiIC8+CiAgPHBhdGggZD0iTTggNlY0YTIgMiAwIDAgMSAyLTJoNGEyIDIgMCAwIDEgMiAydjIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/trash-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Trash2 = createLucideIcon('trash-2', __iconNode);\n\nexport default Trash2;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACzC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACzC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAA4C,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACzE;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAW,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACxC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAA0C,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CACzE;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,MAAA,CAAA,CAAA,KAAS,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,iKAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAW,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}}]
}
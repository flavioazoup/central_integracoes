{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/actions/customers.ts"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\nimport { z } from 'zod'\nimport { getCurrentTenant } from '@/server/services/tenant.service'\nimport {\n    createCustomer,\n    updateCustomer,\n    deleteCustomer,\n    getCustomers,\n    getCustomerById,\n    getCustomerWithIntegrations,\n    getActiveCustomers,\n} from '@/server/services/customer.service'\n\nconst CustomerSchema = z.object({\n    name: z.string().min(1, 'Nome é obrigatório'),\n    email: z.string().email('Email inválido').optional().or(z.literal('')),\n    phone: z.string().optional(),\n    document: z.string().optional(),\n    notes: z.string().optional(),\n})\n\nexport async function createCustomerAction(prevState: any, formData: FormData) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const rawData = {\n        name: formData.get('name'),\n        email: formData.get('email'),\n        phone: formData.get('phone'),\n        document: formData.get('document'),\n        notes: formData.get('notes'),\n    }\n\n    const validatedFields = CustomerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: 'Validation failed',\n        }\n    }\n\n    let customerId: string | undefined\n    try {\n        const customer = await createCustomer(\n            {\n                name: validatedFields.data.name,\n                email: validatedFields.data.email || undefined,\n                phone: validatedFields.data.phone || undefined,\n                document: validatedFields.data.document || undefined,\n                notes: validatedFields.data.notes || undefined,\n            },\n            tenant.id\n        )\n\n        revalidatePath('/dashboard/customers')\n        customerId = customer.id\n    } catch (error) {\n        return { message: 'Failed to create customer' }\n    }\n\n    if (customerId) {\n        redirect(`/dashboard/customers/${customerId}`)\n    }\n}\n\nexport async function updateCustomerAction(\n    customerId: string,\n    prevState: any,\n    formData: FormData\n) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const rawData = {\n        name: formData.get('name'),\n        email: formData.get('email'),\n        phone: formData.get('phone'),\n        document: formData.get('document'),\n        notes: formData.get('notes'),\n    }\n\n    const validatedFields = CustomerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: 'Validation failed',\n        }\n    }\n\n    try {\n        await updateCustomer(\n            customerId,\n            {\n                name: validatedFields.data.name,\n                email: validatedFields.data.email || undefined,\n                phone: validatedFields.data.phone || undefined,\n                document: validatedFields.data.document || undefined,\n                notes: validatedFields.data.notes || undefined,\n            },\n            tenant.id\n        )\n\n        revalidatePath('/dashboard/customers')\n        revalidatePath(`/dashboard/customers/${customerId}`)\n        return { message: 'Success' }\n    } catch (error) {\n        return { message: 'Failed to update customer' }\n    }\n}\n\nexport async function deleteCustomerAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    try {\n        await deleteCustomer(customerId, tenant.id)\n        revalidatePath('/dashboard/customers')\n        redirect('/dashboard/customers')\n    } catch (error) {\n        return { message: 'Failed to delete customer' }\n    }\n}\n\nexport async function getCustomersAction() {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await getCustomers(tenant.id)\n}\n\nexport async function getActiveCustomersAction() {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await getActiveCustomers(tenant.id)\n}\n\nexport async function getCustomerByIdAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return null\n\n    return await getCustomerById(customerId, tenant.id)\n}\n\nexport async function getCustomerWithIntegrationsAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return null\n\n    return await getCustomerWithIntegrations(customerId, tenant.id)\n}\n"],"names":[],"mappings":";;;;;;;MAwBsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,wDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/actions/customers.ts"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\nimport { z } from 'zod'\nimport { getCurrentTenant } from '@/server/services/tenant.service'\nimport {\n    createCustomer,\n    updateCustomer,\n    deleteCustomer,\n    getCustomers,\n    getCustomerById,\n    getCustomerWithIntegrations,\n    getActiveCustomers,\n} from '@/server/services/customer.service'\n\nconst CustomerSchema = z.object({\n    name: z.string().min(1, 'Nome é obrigatório'),\n    email: z.string().email('Email inválido').optional().or(z.literal('')),\n    phone: z.string().optional(),\n    document: z.string().optional(),\n    notes: z.string().optional(),\n})\n\nexport async function createCustomerAction(prevState: any, formData: FormData) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const rawData = {\n        name: formData.get('name'),\n        email: formData.get('email'),\n        phone: formData.get('phone'),\n        document: formData.get('document'),\n        notes: formData.get('notes'),\n    }\n\n    const validatedFields = CustomerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: 'Validation failed',\n        }\n    }\n\n    let customerId: string | undefined\n    try {\n        const customer = await createCustomer(\n            {\n                name: validatedFields.data.name,\n                email: validatedFields.data.email || undefined,\n                phone: validatedFields.data.phone || undefined,\n                document: validatedFields.data.document || undefined,\n                notes: validatedFields.data.notes || undefined,\n            },\n            tenant.id\n        )\n\n        revalidatePath('/dashboard/customers')\n        customerId = customer.id\n    } catch (error) {\n        return { message: 'Failed to create customer' }\n    }\n\n    if (customerId) {\n        redirect(`/dashboard/customers/${customerId}`)\n    }\n}\n\nexport async function updateCustomerAction(\n    customerId: string,\n    prevState: any,\n    formData: FormData\n) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    const rawData = {\n        name: formData.get('name'),\n        email: formData.get('email'),\n        phone: formData.get('phone'),\n        document: formData.get('document'),\n        notes: formData.get('notes'),\n    }\n\n    const validatedFields = CustomerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: 'Validation failed',\n        }\n    }\n\n    try {\n        await updateCustomer(\n            customerId,\n            {\n                name: validatedFields.data.name,\n                email: validatedFields.data.email || undefined,\n                phone: validatedFields.data.phone || undefined,\n                document: validatedFields.data.document || undefined,\n                notes: validatedFields.data.notes || undefined,\n            },\n            tenant.id\n        )\n\n        revalidatePath('/dashboard/customers')\n        revalidatePath(`/dashboard/customers/${customerId}`)\n        return { message: 'Success' }\n    } catch (error) {\n        return { message: 'Failed to update customer' }\n    }\n}\n\nexport async function deleteCustomerAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) {\n        return { message: 'Unauthorized' }\n    }\n\n    try {\n        await deleteCustomer(customerId, tenant.id)\n        revalidatePath('/dashboard/customers')\n        redirect('/dashboard/customers')\n    } catch (error) {\n        return { message: 'Failed to delete customer' }\n    }\n}\n\nexport async function getCustomersAction() {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await getCustomers(tenant.id)\n}\n\nexport async function getActiveCustomersAction() {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await getActiveCustomers(tenant.id)\n}\n\nexport async function getCustomerByIdAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return null\n\n    return await getCustomerById(customerId, tenant.id)\n}\n\nexport async function getCustomerWithIntegrationsAction(customerId: string) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return null\n\n    return await getCustomerWithIntegrations(customerId, tenant.id)\n}\n"],"names":[],"mappings":";;;;;;;MAuEsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,wDAAA"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/components/customer-form.tsx"],"sourcesContent":["'use client'\n\nimport { useActionState } from 'react'\nimport { createCustomerAction, updateCustomerAction } from '@/server/actions/customers'\nimport type { Customer } from '@prisma/client'\n\ninterface CustomerFormProps {\n    customer?: Customer\n    mode: 'create' | 'edit'\n}\n\nexport function CustomerForm({ customer, mode }: CustomerFormProps) {\n    const action = mode === 'create'\n        ? createCustomerAction\n        : updateCustomerAction.bind(null, customer!.id)\n\n    const [state, formAction, isPending] = useActionState(action, null)\n\n    return (\n        <form action={formAction} className=\"space-y-6\">\n            {state?.message && state.message !== 'Success' && (\n                <div className=\"rounded-md bg-red-50 p-4\">\n                    <p className=\"text-sm text-red-800\">{state.message}</p>\n                </div>\n            )}\n\n            <div>\n                <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700\">\n                    Nome <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    defaultValue={customer?.name}\n                    required\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                />\n                {state?.errors?.name && (\n                    <p className=\"mt-1 text-sm text-red-600\">{state.errors.name[0]}</p>\n                )}\n            </div>\n\n            <div>\n                <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                    Email\n                </label>\n                <input\n                    type=\"email\"\n                    id=\"email\"\n                    name=\"email\"\n                    defaultValue={customer?.email || ''}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                />\n                {state?.errors?.email && (\n                    <p className=\"mt-1 text-sm text-red-600\">{state.errors.email[0]}</p>\n                )}\n            </div>\n\n            <div>\n                <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700\">\n                    Telefone\n                </label>\n                <input\n                    type=\"tel\"\n                    id=\"phone\"\n                    name=\"phone\"\n                    defaultValue={customer?.phone || ''}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                />\n                {state?.errors?.phone && (\n                    <p className=\"mt-1 text-sm text-red-600\">{state.errors.phone[0]}</p>\n                )}\n            </div>\n\n            <div>\n                <label htmlFor=\"document\" className=\"block text-sm font-medium text-gray-700\">\n                    CPF/CNPJ\n                </label>\n                <input\n                    type=\"text\"\n                    id=\"document\"\n                    name=\"document\"\n                    defaultValue={customer?.document || ''}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                />\n                {state?.errors?.document && (\n                    <p className=\"mt-1 text-sm text-red-600\">{state.errors.document[0]}</p>\n                )}\n            </div>\n\n            <div>\n                <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700\">\n                    Observações\n                </label>\n                <textarea\n                    id=\"notes\"\n                    name=\"notes\"\n                    rows={4}\n                    defaultValue={customer?.notes || ''}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                />\n                {state?.errors?.notes && (\n                    <p className=\"mt-1 text-sm text-red-600\">{state.errors.notes[0]}</p>\n                )}\n            </div>\n\n            <div className=\"flex justify-end gap-3\">\n                <a\n                    href=\"/dashboard/customers\"\n                    className=\"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50\"\n                >\n                    Cancelar\n                </a>\n                <button\n                    type=\"submit\"\n                    disabled={isPending}\n                    className=\"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50\"\n                >\n                    {isPending ? 'Salvando...' : mode === 'create' ? 'Criar Cliente' : 'Salvar Alterações'}\n                </button>\n            </div>\n        </form>\n    )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAHA;;;AAWO,SAAS,aAAa,EAAE,QAAQ,EAAE,IAAI,EAAqB;;IAC9D,MAAM,SAAS,SAAS,WAClB,2LAAoB,GACpB,2LAAoB,CAAC,IAAI,CAAC,MAAM,SAAU,EAAE;IAElD,MAAM,CAAC,OAAO,YAAY,UAAU,GAAG,IAAA,+KAAc,EAAC,QAAQ;IAE9D,qBACI,6LAAC;QAAK,QAAQ;QAAY,WAAU;;YAC/B,OAAO,WAAW,MAAM,OAAO,KAAK,2BACjC,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAE,WAAU;8BAAwB,MAAM,OAAO;;;;;;;;;;;0BAI1D,6LAAC;;kCACG,6LAAC;wBAAM,SAAQ;wBAAO,WAAU;;4BAA0C;0CACjE,6LAAC;gCAAK,WAAU;0CAAe;;;;;;;;;;;;kCAExC,6LAAC;wBACG,MAAK;wBACL,IAAG;wBACH,MAAK;wBACL,cAAc,UAAU;wBACxB,QAAQ;wBACR,WAAU;;;;;;oBAEb,OAAO,QAAQ,sBACZ,6LAAC;wBAAE,WAAU;kCAA6B,MAAM,MAAM,CAAC,IAAI,CAAC,EAAE;;;;;;;;;;;;0BAItE,6LAAC;;kCACG,6LAAC;wBAAM,SAAQ;wBAAQ,WAAU;kCAA0C;;;;;;kCAG3E,6LAAC;wBACG,MAAK;wBACL,IAAG;wBACH,MAAK;wBACL,cAAc,UAAU,SAAS;wBACjC,WAAU;;;;;;oBAEb,OAAO,QAAQ,uBACZ,6LAAC;wBAAE,WAAU;kCAA6B,MAAM,MAAM,CAAC,KAAK,CAAC,EAAE;;;;;;;;;;;;0BAIvE,6LAAC;;kCACG,6LAAC;wBAAM,SAAQ;wBAAQ,WAAU;kCAA0C;;;;;;kCAG3E,6LAAC;wBACG,MAAK;wBACL,IAAG;wBACH,MAAK;wBACL,cAAc,UAAU,SAAS;wBACjC,WAAU;;;;;;oBAEb,OAAO,QAAQ,uBACZ,6LAAC;wBAAE,WAAU;kCAA6B,MAAM,MAAM,CAAC,KAAK,CAAC,EAAE;;;;;;;;;;;;0BAIvE,6LAAC;;kCACG,6LAAC;wBAAM,SAAQ;wBAAW,WAAU;kCAA0C;;;;;;kCAG9E,6LAAC;wBACG,MAAK;wBACL,IAAG;wBACH,MAAK;wBACL,cAAc,UAAU,YAAY;wBACpC,WAAU;;;;;;oBAEb,OAAO,QAAQ,0BACZ,6LAAC;wBAAE,WAAU;kCAA6B,MAAM,MAAM,CAAC,QAAQ,CAAC,EAAE;;;;;;;;;;;;0BAI1E,6LAAC;;kCACG,6LAAC;wBAAM,SAAQ;wBAAQ,WAAU;kCAA0C;;;;;;kCAG3E,6LAAC;wBACG,IAAG;wBACH,MAAK;wBACL,MAAM;wBACN,cAAc,UAAU,SAAS;wBACjC,WAAU;;;;;;oBAEb,OAAO,QAAQ,uBACZ,6LAAC;wBAAE,WAAU;kCAA6B,MAAM,MAAM,CAAC,KAAK,CAAC,EAAE;;;;;;;;;;;;0BAIvE,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBACG,MAAK;wBACL,WAAU;kCACb;;;;;;kCAGD,6LAAC;wBACG,MAAK;wBACL,UAAU;wBACV,WAAU;kCAET,YAAY,gBAAgB,SAAS,WAAW,kBAAkB;;;;;;;;;;;;;;;;;;AAKvF;GAjHgB;;QAK2B,+KAAc;;;KALzC"}}]
}
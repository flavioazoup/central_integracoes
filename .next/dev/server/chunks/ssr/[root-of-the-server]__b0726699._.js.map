{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\nimport { Pool } from 'pg'\nimport { PrismaPg } from '@prisma/adapter-pg'\n\nconst prismaClientSingleton = () => {\n    const pool = new Pool({ connectionString: process.env.DATABASE_URL })\n    const adapter = new PrismaPg(pool)\n    return new PrismaClient({ adapter })\n}\n\ntype PrismaClientSingleton = ReturnType<typeof prismaClientSingleton>\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClientSingleton | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? prismaClientSingleton()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,wBAAwB;IAC1B,MAAM,OAAO,IAAI,qJAAI,CAAC;QAAE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAAC;IACnE,MAAM,UAAU,IAAI,uKAAQ,CAAC;IAC7B,OAAO,IAAI,sMAAY,CAAC;QAAE;IAAQ;AACtC;AAIA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI;AAEhD,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/services/tenant.service.ts"],"sourcesContent":["import { prisma } from '@/lib/prisma'\nimport { auth, currentUser } from '@clerk/nextjs/server'\n\nexport async function getCurrentTenant() {\n    const { userId, orgId } = await auth();\n    if (!userId) return null;\n    const clerkId = orgId || userId;\n\n    let tenant = await prisma.tenant.findUnique({\n        where: { clerkId },\n    })\n\n    if (!tenant) {\n        const user = await currentUser();\n        const name = (await auth()).orgId ? 'Organization' : (user?.firstName ? `${user.firstName}'s Store` : 'My Store')\n\n        tenant = await prisma.tenant.create({\n            data: {\n                clerkId,\n                name,\n            },\n        })\n    }\n\n    return tenant\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;;;;;AAEO,eAAe;IAClB,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAA,2LAAI;IACpC,IAAI,CAAC,QAAQ,OAAO;IACpB,MAAM,UAAU,SAAS;IAEzB,IAAI,SAAS,MAAM,8HAAM,CAAC,MAAM,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE;QAAQ;IACrB;IAEA,IAAI,CAAC,QAAQ;QACT,MAAM,OAAO,MAAM,IAAA,yMAAW;QAC9B,MAAM,OAAO,CAAC,MAAM,IAAA,2LAAI,GAAE,EAAE,KAAK,GAAG,iBAAkB,MAAM,YAAY,GAAG,KAAK,SAAS,CAAC,QAAQ,CAAC,GAAG;QAEtG,SAAS,MAAM,8HAAM,CAAC,MAAM,CAAC,MAAM,CAAC;YAChC,MAAM;gBACF;gBACA;YACJ;QACJ;IACJ;IAEA,OAAO;AACX"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/server/queries/jobs.ts"],"sourcesContent":["import { prisma } from '@/lib/prisma'\nimport { getCurrentTenant } from '@/server/services/tenant.service'\n\nexport async function getRecentJobs(limit = 20) {\n    const tenant = await getCurrentTenant()\n    if (!tenant) return []\n\n    return await prisma.syncJob.findMany({\n        where: { tenantId: tenant.id },\n        orderBy: { startedAt: 'desc' },\n        take: limit,\n        include: {\n            integration: {\n                select: {\n                    name: true,\n                    provider: true,\n                    customer: {\n                        select: {\n                            name: true,\n                        },\n                    },\n                },\n            },\n        },\n    })\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;;AAEO,eAAe,cAAc,QAAQ,EAAE;IAC1C,MAAM,SAAS,MAAM,IAAA,kKAAgB;IACrC,IAAI,CAAC,QAAQ,OAAO,EAAE;IAEtB,OAAO,MAAM,8HAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;QACjC,OAAO;YAAE,UAAU,OAAO,EAAE;QAAC;QAC7B,SAAS;YAAE,WAAW;QAAO;QAC7B,MAAM;QACN,SAAS;YACL,aAAa;gBACT,QAAQ;oBACJ,MAAM;oBACN,UAAU;oBACV,UAAU;wBACN,QAAQ;4BACJ,MAAM;wBACV;oBACJ;gBACJ;YACJ;QACJ;IACJ;AACJ"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/flavioazoup/Desenvolvimento/central_integracoes/src/app/dashboard/sync-status/page.tsx"],"sourcesContent":["import { getRecentJobs } from '@/server/queries/jobs'\nimport { formatDistanceToNow } from 'date-fns'\nimport { Activity, AlertCircle, CheckCircle2, Clock, XCircle, Building2 } from 'lucide-react'\n\nexport default async function SyncStatusPage() {\n    const jobs = await getRecentJobs()\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n                <h1 className=\"text-2xl font-bold text-gray-900\">Sync Status</h1>\n            </div>\n\n            <div className=\"overflow-hidden rounded-lg bg-white shadow\">\n                <div className=\"px-4 py-5 sm:px-6\">\n                    <h3 className=\"text-base font-semibold leading-6 text-gray-900\">Recent Jobs</h3>\n                    <p className=\"mt-1 max-w-2xl text-sm text-gray-500\">Overview of recent synchronization activities.</p>\n                </div>\n                <div className=\"border-t border-gray-200\">\n                    <ul role=\"list\" className=\"divide-y divide-gray-200\">\n                        {jobs.length === 0 ? (\n                            <li className=\"px-4 py-4 sm:px-6 text-center text-sm text-gray-500\">No jobs found.</li>\n                        ) : (\n                            jobs.map((job) => (\n                                <li key={job.id} className=\"px-4 py-4 sm:px-6 hover:bg-gray-50\">\n                                    <div className=\"flex items-center justify-between\">\n                                        <div className=\"flex items-center\">\n                                            <div className=\"mr-4 flex-shrink-0\">\n                                                {job.status === 'completed' && <CheckCircle2 className=\"h-6 w-6 text-green-500\" />}\n                                                {job.status === 'failed' && <XCircle className=\"h-6 w-6 text-red-500\" />}\n                                                {job.status === 'processing' && <Activity className=\"h-6 w-6 text-blue-500 animate-pulse\" />}\n                                                {job.status === 'pending' && <Clock className=\"h-6 w-6 text-gray-400\" />}\n                                            </div>\n                                            <div>\n                                                <p className=\"truncate text-sm font-medium text-indigo-600\">{job.type.toUpperCase()}</p>\n                                                <p className=\"flex items-center text-sm text-gray-500\">\n                                                    <span className=\"truncate\">{job.integration.name} ({job.integration.provider})</span>\n                                                </p>\n                                                {job.integration.customer && (\n                                                    <p className=\"flex items-center gap-1 text-xs text-gray-500 mt-1\">\n                                                        <Building2 className=\"h-3 w-3\" />\n                                                        <span>{job.integration.customer.name}</span>\n                                                    </p>\n                                                )}\n                                            </div>\n                                        </div>\n                                        <div className=\"flex flex-col items-end\">\n                                            <p className=\"text-sm text-gray-900 capitalize\">\n                                                {job.status}\n                                            </p>\n                                            <p className=\"mt-1 flex items-center text-xs text-gray-500\">\n                                                {job.completedAt ? (\n                                                    `Completed ${formatDistanceToNow(new Date(job.completedAt), { addSuffix: true })}`\n                                                ) : (\n                                                    `Started ${formatDistanceToNow(new Date(job.startedAt), { addSuffix: true })}`\n                                                )}\n                                            </p>\n                                        </div>\n                                    </div>\n                                    {job.message && (\n                                        <div className={`mt-2 text-xs p-2 rounded ${job.status === 'failed'\n                                                ? 'text-red-600 bg-red-50'\n                                                : 'text-green-600 bg-green-50'\n                                            }`}>\n                                            {job.message}\n                                        </div>\n                                    )}\n                                </li>\n                            ))\n                        )}\n\n                    </ul>\n                </div>\n            </div>\n        </div>\n    )\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;AAEe,eAAe;IAC1B,MAAM,OAAO,MAAM,IAAA,iJAAa;IAEhC,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAG,WAAU;8BAAmC;;;;;;;;;;;0BAGrD,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAG,WAAU;0CAAkD;;;;;;0CAChE,8OAAC;gCAAE,WAAU;0CAAuC;;;;;;;;;;;;kCAExD,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC;4BAAG,MAAK;4BAAO,WAAU;sCACrB,KAAK,MAAM,KAAK,kBACb,8OAAC;gCAAG,WAAU;0CAAsD;;;;;uCAEpE,KAAK,GAAG,CAAC,CAAC,oBACN,8OAAC;oCAAgB,WAAU;;sDACvB,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAI,WAAU;;gEACV,IAAI,MAAM,KAAK,6BAAe,8OAAC,qOAAY;oEAAC,WAAU;;;;;;gEACtD,IAAI,MAAM,KAAK,0BAAY,8OAAC,uNAAO;oEAAC,WAAU;;;;;;gEAC9C,IAAI,MAAM,KAAK,8BAAgB,8OAAC,sNAAQ;oEAAC,WAAU;;;;;;gEACnD,IAAI,MAAM,KAAK,2BAAa,8OAAC,6MAAK;oEAAC,WAAU;;;;;;;;;;;;sEAElD,8OAAC;;8EACG,8OAAC;oEAAE,WAAU;8EAAgD,IAAI,IAAI,CAAC,WAAW;;;;;;8EACjF,8OAAC;oEAAE,WAAU;8EACT,cAAA,8OAAC;wEAAK,WAAU;;4EAAY,IAAI,WAAW,CAAC,IAAI;4EAAC;4EAAG,IAAI,WAAW,CAAC,QAAQ;4EAAC;;;;;;;;;;;;gEAEhF,IAAI,WAAW,CAAC,QAAQ,kBACrB,8OAAC;oEAAE,WAAU;;sFACT,8OAAC,6NAAS;4EAAC,WAAU;;;;;;sFACrB,8OAAC;sFAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI;;;;;;;;;;;;;;;;;;;;;;;;8DAKpD,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAE,WAAU;sEACR,IAAI,MAAM;;;;;;sEAEf,8OAAC;4DAAE,WAAU;sEACR,IAAI,WAAW,GACZ,CAAC,UAAU,EAAE,IAAA,yKAAmB,EAAC,IAAI,KAAK,IAAI,WAAW,GAAG;gEAAE,WAAW;4DAAK,IAAI,GAElF,CAAC,QAAQ,EAAE,IAAA,yKAAmB,EAAC,IAAI,KAAK,IAAI,SAAS,GAAG;gEAAE,WAAW;4DAAK,IAAI;;;;;;;;;;;;;;;;;;wCAK7F,IAAI,OAAO,kBACR,8OAAC;4CAAI,WAAW,CAAC,yBAAyB,EAAE,IAAI,MAAM,KAAK,WACjD,2BACA,8BACJ;sDACD,IAAI,OAAO;;;;;;;mCAxCf,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoD/C"}}]
}